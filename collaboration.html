<!DOCTYPE html> 
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>collaborations between authors</title>
		<script type="text/javascript" src="https://d3js.org/d3.v3.min.js"> </script> 
		<!-- <script type="text/javascript" src="d3.v3.js"> </script> -->
		
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
		<style>
			.link {
			  	stroke: #999;
		  		
			}
			.node {
			  stroke: #FFFFE0;
			  stroke-width: 1.5px;
			}
	  		
			.node text {
				pointer-events: none;
			 	font: 10px sans-serif;
			  	
			}
		</style>
	</head>
	<body>
		<div class="SettingWrap" style="margin-top: 0px; margin-bottom: 15px">
			<div class = "sourceSet" style="display:inline">
				<div style="font-size: 16px; display:inline;">Source</div>
				
				<div style=" display:inline;" >
					<select id = "sourceselect"> </select>
			 	</div>
			</div>
			<div id = "forcegraph" style="margin-top: 0px; margin-bottom: 15px">
				
			</div>
			
		</div>
		<script type="text/javascript"> 
			var filepath = "dataset/itsec"
			var sselect=d3.select("#sourceselect");
			var soptions=sselect.selectAll('option').data(["IEEE intelligent tranporationsystem", "IEEE Transactions on Evolutionary Computation", "IEEE ITS conference"])
				.enter().append('option').text(function(d){
					return d;
				}).property("selected", function(d){ return d == "IEEE Transactions on Evolutionary Computation"; });
			sselect.on("change",function(){
				var sstr= d3.select('#sourceselect').node().value;
				if(sstr == "IEEE intelligent tranporationsystem"){
					filepath =  "dataset/its2"
					reset();
				}
				else if(sstr == "IEEE Transactions on Evolutionary Computation"){
					filepath =  "dataset/itsec"
					reset();
				}
				else {
					filepath =  "dataset/itsconf"
					reset();
				}
			});
			var width = 960,
		    	height = 500

			var svg = d3.select("#forcegraph").append("svg")
		    	.attr("width", width)
		    	.attr("height", height);

			var force = d3.layout.force()
		    	.gravity(0.05)
		    	
		    	.charge(-100)
		    	.size([width, height]);
			initial()
			function reset(){
				d3.selectAll('svg > *').remove();
				initial();
			}
			function initial(){
				d3.csv(filepath+"_cooperation.csv", function(error, links) {
					if (error) throw error;
					var nodesByName = {};
					links.forEach(function(link) {
					    link.source = nodeByName(link.source);
					    link.target = nodeByName(link.target);
						link.value = nodeByName(link.valu);
					});
					var nodes = d3.values(nodesByName);
					
			  	  	var link = svg.selectAll(".link")
			        	.data(links)
			      		.enter().append("line")
			        	.attr("class", "link");
				  	var node = svg.selectAll(".node")
				        .data(nodes)
				      	.enter().append("circle")
				        .attr("class", "node")
				        .attr("r", 4.5)
				        .call(force.drag);
				  	force.nodes(nodes)
				        .links(links)
						.linkDistance(100)
				        .on("tick", tick)
				        .start();
					function tick() {
						link.attr("x1", function(d) { return d.source.x; })
					        .attr("y1", function(d) { return d.source.y; })
					        .attr("x2", function(d) { return d.target.x; })
					        .attr("y2", function(d) { return d.target.y; });

						node.attr("cx", function(d) { return d.x; })
					        .attr("cy", function(d) { return d.y; });
					  	}
					function nodeByName(name) {
					    return nodesByName[name] || (nodesByName[name] = {name: name});
					}
				});
				
				// d3.csv(filepath+"_GN.csv", function(error, GNdata) {
// 					if (error) { //if error !=null print out the error in console
// 						console.log(error); }
// 					else {
// 						var nodes=GNdata
//
// 						d3.csv(filepath+"_cooperation.csv", function(error, Coocdata) {
// 							if (error) { //if error !=null print out the error in console
// 								console.log(error); }
// 							else {
// 								var links=Coocdata
// 								console.log("++++++++++++++++++++++++++++++++++");
// 								// +++++++++++++++++++++++++++++++++++++++++++++
// 						  	  	force
// 						        	.nodes(GNdata)
// 						        	.links(Coocdata)
// 						        	.start();
// 							  	var link = svg.selectAll(".link")
// 							        .data(links)
// 							      	.enter().append("line")
// 							        .attr("class", "link");
// 							  	var node = svg.selectAll(".node")
// 							        .data(nodes)
// 							      	.enter().append("g")
// 							        .attr("class", "node")
// 							        .call(force.drag);
// 							  	xnode.append("image")
// 							        .attr("xlink:href", "https://github.com/favicon.ico")
// 							        .attr("x", -8)
// 							        .attr("y", -8)
// 							        .attr("width", 16)
// 							        .attr("height", 16);
// 								node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
// 								// +++++++++++++++++++++++++++++++++++++++++++++
//
// 							}
// 						});
//
// 					}
// 				});
			}
			
		</script>
	</body>
</html>